# 1 - Network Accessible Log
In this exercise we'll be building a network exposed log structure. This means
that we'll create an HTTP server, which accepts arbitrary data and writes it to
a log.

## Task
Write an HTTP server that accepts arbitrary input and logs it to a file a
single line at the time. There is no need to escape newlines, as we have full
control over data input. Expose the server on port `8080`. Open the file
descriptor for the stream at `/tmp/patterns-workshop.db`. Respond with a `200`
status code.

## Tips
- Use [`http.createServer()`][createserver] to create an `http` server
- Streaming data from an incoming http request can be done using
  `req.pipe(destinationStream)`
- Writing lines to a file can be done by using
  [`fs.createWriteStream()`][fs-writestream]
- To make the write stream append, rather than override, pass
  [`{ flags: 'a '}`][fs-append] as the second argument
- For simplicity sake there's no need to worry about escaping newlines

## Testing
Run your network exposed log structure, write a few lines to it over HTTP and
then check the content has been written to it:
```sh
$ curl localhost:8080 -X POST --data-binary "[$(date +'%s')] line 1\n"
$ curl localhost:8080 -X POST --data-binary "[$(date +'%s')] line 2\n"
$ tail -f /tmp/patterns-workshop.db
```

Be careful not to use the `-d` flag in `curl(1)` as it will try and escape
newlines. `--data-binary` will allow us to send raw bits, which is useful for
this workshop since we'll not be worrying about data sanitation of any kind.

---
[Click here to go to the next exercise](build/02.html)

[createserver]: https://nodejs.org/api/http.html#http_http_createserver_requestlistener
[fs-writestream]: https://nodejs.org/api/fs.html#fs_fs_createwritestream_path_options
[fs-append]: https://nodejs.org/api/fs.html#fs_fs_open_path_flags_mode_callback
